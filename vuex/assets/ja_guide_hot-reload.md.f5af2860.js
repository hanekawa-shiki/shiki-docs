import{_ as n,y as s,x as a,W as t}from"./plugin-vue_export-helper.0b0d78d5.js";const f='{"title":"\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C7\u30A3\u30F3\u30B0","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u52D5\u7684\u30E2\u30B8\u30E5\u30FC\u30EB\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C7\u30A3\u30F3\u30B0","slug":"\u52D5\u7684\u30E2\u30B8\u30E5\u30FC\u30EB\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C7\u30A3\u30F3\u30B0"}],"relativePath":"ja/guide/hot-reload.md","lastUpdated":1702210160127}',p={},o=t(`<h1 id="\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C7\u30A3\u30F3\u30B0" tabindex="-1">\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C7\u30A3\u30F3\u30B0 <a class="header-anchor" href="#\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C7\u30A3\u30F3\u30B0" aria-hidden="true">#</a></h1><p>Vuex \u306F webpack \u306E <a href="https://webpack.js.org/guides/hot-module-replacement/" target="_blank" rel="noopener noreferrer">Hot Module Replacement API</a> \u3092\u4F7F\u7528\u3059\u308B\u3053\u3068\u3067\u3001\u30A2\u30D7\u30EA\u30B1\u30FC\u30B7\u30E7\u30F3\u306E\u958B\u767A\u3092\u884C\u3063\u3066\u3044\u308B\u9593\u306E\u30DF\u30E5\u30FC\u30C6\u30FC\u30B7\u30E7\u30F3\u3001\u30E2\u30B8\u30E5\u30FC\u30EB\u3001\u30A2\u30AF\u30B7\u30E7\u30F3\u3001\u30B2\u30C3\u30BF\u30FC\u306E\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C7\u30A3\u30F3\u30B0\u3092\u30B5\u30DD\u30FC\u30C8\u3057\u307E\u3059\u3002Browserify \u3067\u306F <a href="https://github.com/AgentME/browserify-hmr/" target="_blank" rel="noopener noreferrer">browserify-hmr</a> \u30D7\u30E9\u30B0\u30A4\u30F3\u3092\u4F7F\u7528\u3059\u308B\u3053\u3068\u304C\u3067\u304D\u307E\u3059\u3002</p><p>\u30DF\u30E5\u30FC\u30C6\u30FC\u30B7\u30E7\u30F3\u3068\u30E2\u30B8\u30E5\u30FC\u30EB\u306E\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C7\u30A3\u30F3\u30B0\u306E\u305F\u3081\u306B\u3001<code>store.hotUpdate()</code> API \u30E1\u30BD\u30C3\u30C9\u3092\u5229\u7528\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059:</p><div class="language-js"><pre><code><span class="token comment">// store.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vuex&#39;</span>
<span class="token keyword">import</span> mutations <span class="token keyword">from</span> <span class="token string">&#39;./mutations&#39;</span>
<span class="token keyword">import</span> moduleA <span class="token keyword">from</span> <span class="token string">&#39;./modules/a&#39;</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token punctuation">,</span>
  mutations<span class="token punctuation">,</span>
  <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> moduleA
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u30DB\u30C3\u30C8\u30E2\u30B8\u30E5\u30FC\u30EB\u3068\u3057\u3066\u30A2\u30AF\u30B7\u30E7\u30F3\u3068\u30E2\u30B8\u30E5\u30FC\u30EB\u3092\u53D7\u3051\u4ED8\u3051\u307E\u3059</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;./mutations&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;./modules/a&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u66F4\u65B0\u3055\u308C\u305F\u30E2\u30B8\u30E5\u30FC\u30EB\u3092\u30A4\u30F3\u30DD\u30FC\u30C8\u3059\u308B</span>
    <span class="token comment">// babel 6 \u306E\u30E2\u30B8\u30E5\u30FC\u30EB\u51FA\u529B\u306E\u305F\u3081\u3001\u3053\u3053\u3067\u306F .default \u3092\u8FFD\u52A0\u3057\u306A\u3051\u308C\u3070\u306A\u3089\u306A\u3044</span>
    <span class="token keyword">const</span> newMutations <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./mutations&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default
    <span class="token keyword">const</span> newModuleA <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./modules/a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default
    <span class="token comment">// \u65B0\u3057\u3044\u30E2\u30B8\u30E5\u30FC\u30EB\u3068\u30DF\u30E5\u30FC\u30C6\u30FC\u30B7\u30E7\u30F3\u306B\u30B9\u30EF\u30C3\u30D7</span>
    store<span class="token punctuation">.</span><span class="token function">hotUpdate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">mutations</span><span class="token operator">:</span> newMutations<span class="token punctuation">,</span>
      <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">a</span><span class="token operator">:</span> newModuleA
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C7\u30A3\u30F3\u30B0\u3092\u8A66\u3057\u305F\u3044\u5834\u5408\u306F\u3001<a href="https://github.com/vuejs/vuex/tree/main/examples/counter-hot" target="_blank" rel="noopener noreferrer">counter-hot example</a>\u3092\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3057\u3066\u304F\u3060\u3055\u3044\u3002</p><h2 id="\u52D5\u7684\u30E2\u30B8\u30E5\u30FC\u30EB\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C7\u30A3\u30F3\u30B0" tabindex="-1">\u52D5\u7684\u30E2\u30B8\u30E5\u30FC\u30EB\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C7\u30A3\u30F3\u30B0 <a class="header-anchor" href="#\u52D5\u7684\u30E2\u30B8\u30E5\u30FC\u30EB\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C7\u30A3\u30F3\u30B0" aria-hidden="true">#</a></h2><p>\u3082\u3057\u30B9\u30C8\u30A2\u3067\u30E2\u30B8\u30E5\u30FC\u30EB\u3060\u3051\u3092\u4F7F\u7528\u3057\u3066\u3044\u308B\u5834\u5408\u306B\u306F\u3001<code>require.context</code> \u3092\u4F7F\u3063\u3066\u5168\u3066\u306E\u30E2\u30B8\u30E5\u30FC\u30EB\u3092\u52D5\u7684\u306B\u8AAD\u307F\u8FBC\u3080\u3053\u3068\u3082\u3067\u304D\u307E\u3059\u3002</p><div class="language-js"><pre><code><span class="token comment">// store.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vuex&#39;</span>

<span class="token comment">// \u5168\u3066\u306E\u30E2\u30B8\u30E5\u30FC\u30EB\u3092\u30ED\u30FC\u30C9\u3059\u308B</span>
<span class="token keyword">function</span> <span class="token function">loadModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> context <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">&quot;./modules&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">([a-z_]+)\\.js$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> modules <span class="token operator">=</span> context
    <span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> key<span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> key<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">([a-z_]+)\\.js$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token parameter">modules<span class="token punctuation">,</span> <span class="token punctuation">{</span> key<span class="token punctuation">,</span> name <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>modules<span class="token punctuation">,</span>
        <span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token function">context</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>default
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> context<span class="token punctuation">,</span> modules <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> context<span class="token punctuation">,</span> modules <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">loadModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  modules
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u30E2\u30B8\u30E5\u30FC\u30EB\u306B\u5909\u66F4\u304C\u3042\u3063\u305F\u5834\u5408\u306B\u30DB\u30C3\u30C8\u30EA\u30ED\u30FC\u30C9\u3059\u308B</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> modules <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">loadModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    store<span class="token punctuation">.</span><span class="token function">hotUpdate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      modules
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div>`,8),e=[o];function c(u,l,k,r,i,d){return a(),s("div",null,e)}var g=n(p,[["render",c]]);export{f as __pageData,g as default};
